
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>T2VEC &#8212; TrajDL 0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=a1637f0b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"b30f1090a82f47ae809283c66dbef763": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "022f500a26bb49bdacd249a850ba18f1": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c08383d9820a406d848f1c409e661140": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b30f1090a82f47ae809283c66dbef763", "max": 10000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_022f500a26bb49bdacd249a850ba18f1", "tabbable": null, "tooltip": null, "value": 10000.0}}, "07fa1917544e40ca8920765e4f039783": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b126411e787942eb823d88189d8802e8": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d470b56f9fdb436f94da58ffaa9ee364": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_07fa1917544e40ca8920765e4f039783", "placeholder": "\u200b", "style": "IPY_MODEL_b126411e787942eb823d88189d8802e8", "tabbable": null, "tooltip": null, "value": "transform\u2007trajectorys:\u2007100%"}}, "bcb671b2574f4fc19802540d62ef9887": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7fb4226ec44643baa1d217daa483442e": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "da14494be74148838dc30b6d69b4b883": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_bcb671b2574f4fc19802540d62ef9887", "placeholder": "\u200b", "style": "IPY_MODEL_7fb4226ec44643baa1d217daa483442e", "tabbable": null, "tooltip": null, "value": "\u200710000/10000\u2007[00:00&lt;00:00,\u2007143557.46it/s]"}}, "edd4816e092e4ba28c22cff18e77aa42": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "43275d8b7ed64bfc8335933ce8152cce": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d470b56f9fdb436f94da58ffaa9ee364", "IPY_MODEL_c08383d9820a406d848f1c409e661140", "IPY_MODEL_da14494be74148838dc30b6d69b4b883"], "layout": "IPY_MODEL_edd4816e092e4ba28c22cff18e77aa42", "tabbable": null, "tooltip": null}}, "3a5f253eadc3438c9f8a406cdd38400e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "564c8af4453743de885aded698b09740": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "fc20da53a6f7497a87450e5b1523cc96": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3a5f253eadc3438c9f8a406cdd38400e", "max": 900.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_564c8af4453743de885aded698b09740", "tabbable": null, "tooltip": null, "value": 900.0}}, "4c49159ec2cf4c9c9d8205a2eede8ada": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3ce82f48c7f242f0bfd3b2c1d7abbf1f": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "4363428dc18c4f33b10fcdabebec3d03": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_4c49159ec2cf4c9c9d8205a2eede8ada", "placeholder": "\u200b", "style": "IPY_MODEL_3ce82f48c7f242f0bfd3b2c1d7abbf1f", "tabbable": null, "tooltip": null, "value": "construct\u2007train\u2007and\u2007val\u2007set:\u2007100%"}}, "0c53b9876eb646369deb7f37c54cfe1b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0d046ac144a740669d9369c2dac6bbd5": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c9c9cc710c564dd890a58750a60bb50f": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0c53b9876eb646369deb7f37c54cfe1b", "placeholder": "\u200b", "style": "IPY_MODEL_0d046ac144a740669d9369c2dac6bbd5", "tabbable": null, "tooltip": null, "value": "\u2007900/900\u2007[00:00&lt;00:00,\u2007134889.18it/s]"}}, "d22ae811174049c9b1ae54b732f59f89": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "53107221c65845d4a4efb0b75e9642ef": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_4363428dc18c4f33b10fcdabebec3d03", "IPY_MODEL_fc20da53a6f7497a87450e5b1523cc96", "IPY_MODEL_c9c9cc710c564dd890a58750a60bb50f"], "layout": "IPY_MODEL_d22ae811174049c9b1ae54b732f59f89", "tabbable": null, "tooltip": null}}, "f448b44084ab4699a2f2382280fb3da7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1dd9fed1830b43f9a38110783c39cc05": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "f80ca5a5494e4a25b71b44a2b4694b34": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f448b44084ab4699a2f2382280fb3da7", "max": 100.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_1dd9fed1830b43f9a38110783c39cc05", "tabbable": null, "tooltip": null, "value": 100.0}}, "954c873618de48adbebcb6f1e591df20": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d72de6552c224a7ba5ee9608f250a399": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a66477186ad44a6980f7dcc53d568036": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_954c873618de48adbebcb6f1e591df20", "placeholder": "\u200b", "style": "IPY_MODEL_d72de6552c224a7ba5ee9608f250a399", "tabbable": null, "tooltip": null, "value": "construct\u2007test\u2007set:\u2007100%"}}, "0a55d7e993244a54ab6630678c3da648": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3f3df32ce1b041239508e260bbcb1cca": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c3783356e8064af29ee7e95c529b3633": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0a55d7e993244a54ab6630678c3da648", "placeholder": "\u200b", "style": "IPY_MODEL_3f3df32ce1b041239508e260bbcb1cca", "tabbable": null, "tooltip": null, "value": "\u2007100/100\u2007[00:00&lt;00:00,\u200713973.56it/s]"}}, "af7eb8d8bc8c4eabb626e48cdd597257": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1112e73dea2a46c498c00c156e2b7503": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_a66477186ad44a6980f7dcc53d568036", "IPY_MODEL_f80ca5a5494e4a25b71b44a2b4694b34", "IPY_MODEL_c3783356e8064af29ee7e95c529b3633"], "layout": "IPY_MODEL_af7eb8d8bc8c4eabb626e48cdd597257", "tabbable": null, "tooltip": null}}, "f6234eb7e41340a3a426a8d060eca942": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3ae6b44a12fe4e058d366b77b1890862": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "0df3ee89a2444caba84fb58a1200e24b": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f6234eb7e41340a3a426a8d060eca942", "max": 2.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_3ae6b44a12fe4e058d366b77b1890862", "tabbable": null, "tooltip": null, "value": 2.0}}, "6f748b8cc2b1411ba7c929ac2f585117": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c1165589c0e242d3a79ea257c1370a1f": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "87c6f786ae4f42cdba315251d29e1886": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_6f748b8cc2b1411ba7c929ac2f585117", "placeholder": "\u200b", "style": "IPY_MODEL_c1165589c0e242d3a79ea257c1370a1f", "tabbable": null, "tooltip": null, "value": "Sanity\u2007Checking\u2007DataLoader\u20070:\u2007100%"}}, "804eaccf33ef43ff864da55b9f79a82b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "06564d91c4fe4dd1be6570c01f370cbb": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a3e7268ea6764d3cbf93832ce444bc1e": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_804eaccf33ef43ff864da55b9f79a82b", "placeholder": "\u200b", "style": "IPY_MODEL_06564d91c4fe4dd1be6570c01f370cbb", "tabbable": null, "tooltip": null, "value": "\u20072/2\u2007[00:00&lt;00:00,\u200719.09it/s]"}}, "e3c3a178bdf54acf89c8364452188e51": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": "100%"}}, "f6c9b6040ed248c29baf62090afd3b37": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_87c6f786ae4f42cdba315251d29e1886", "IPY_MODEL_0df3ee89a2444caba84fb58a1200e24b", "IPY_MODEL_a3e7268ea6764d3cbf93832ce444bc1e"], "layout": "IPY_MODEL_e3c3a178bdf54acf89c8364452188e51", "tabbable": null, "tooltip": null}}, "aa19878e99454e558cca00d93895dfee": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "25a5b2b18b53494eba9d5466e55ae787": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "8b666f2c062542d2963598b76de62db7": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_aa19878e99454e558cca00d93895dfee", "max": 10.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_25a5b2b18b53494eba9d5466e55ae787", "tabbable": null, "tooltip": null, "value": 10.0}}, "11672741ec0c482ab64d6cf399186973": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "da4cfbdef98f4e1283fa923f89cdea8d": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "8bae89582fb24e7b90d2270fb786a46c": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_11672741ec0c482ab64d6cf399186973", "placeholder": "\u200b", "style": "IPY_MODEL_da4cfbdef98f4e1283fa923f89cdea8d", "tabbable": null, "tooltip": null, "value": "Epoch\u20070:\u2007100%"}}, "2209c2d04cc94f96939cb984d16f46b0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9840317e5a864e0c86c7b686887a777b": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "75316a5dac4b418d87eec90549f5d41d": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2209c2d04cc94f96939cb984d16f46b0", "placeholder": "\u200b", "style": "IPY_MODEL_9840317e5a864e0c86c7b686887a777b", "tabbable": null, "tooltip": null, "value": "\u200710/10\u2007[00:01&lt;00:00,\u2007\u20078.59it/s]"}}, "86e63f3b31d74ab8b4a7359cb1f6c95f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "21331174405a4e0c9c2f7a234b8ab6c5": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_8bae89582fb24e7b90d2270fb786a46c", "IPY_MODEL_8b666f2c062542d2963598b76de62db7", "IPY_MODEL_75316a5dac4b418d87eec90549f5d41d"], "layout": "IPY_MODEL_86e63f3b31d74ab8b4a7359cb1f6c95f", "tabbable": null, "tooltip": null}}, "9195b6f6b19f49f88145692156863714": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7cde458ea56e49959c8d7dbfe03a41c3": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c254d6a78d954853856c687c2d605d3b": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9195b6f6b19f49f88145692156863714", "max": 10.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_7cde458ea56e49959c8d7dbfe03a41c3", "tabbable": null, "tooltip": null, "value": 10.0}}, "73c7225c28c8456fad6a65764641f0be": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e311c28770054d04b4aa5bb8640d8f86": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "4f4dd0a4e393489e84878834c004f4e6": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_73c7225c28c8456fad6a65764641f0be", "placeholder": "\u200b", "style": "IPY_MODEL_e311c28770054d04b4aa5bb8640d8f86", "tabbable": null, "tooltip": null, "value": "Validation\u2007DataLoader\u20070:\u2007100%"}}, "aa0308eba3f241b2ab7ca4e701f91bfb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "20f594fd0b094b18ae9af17c0b2b52f9": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "627c8351e07a461eb124c633fb21e014": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_aa0308eba3f241b2ab7ca4e701f91bfb", "placeholder": "\u200b", "style": "IPY_MODEL_20f594fd0b094b18ae9af17c0b2b52f9", "tabbable": null, "tooltip": null, "value": "\u200710/10\u2007[00:00&lt;00:00,\u200735.30it/s]"}}, "d4af06c88dc6466e81560c57db1ad675": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": "100%"}}, "6707ca8e6537420db2f0eed2c9d3688f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_4f4dd0a4e393489e84878834c004f4e6", "IPY_MODEL_c254d6a78d954853856c687c2d605d3b", "IPY_MODEL_627c8351e07a461eb124c633fb21e014"], "layout": "IPY_MODEL_d4af06c88dc6466e81560c57db1ad675", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/t2vec_example';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GMVSAE" href="gmvsae_example.html" />
    <link rel="prev" title="Hands-on Example" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/wide-logo.svg" class="logo__image only-light" alt="TrajDL documentation - Home"/>
    <img src="../_static/wide-logo.svg" class="logo__image only-dark pst-js-only" alt="TrajDL documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Spatial-Temporal-Data-Mining/TrajDL" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">🚀 Quick Start</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quick_start.html">Quick Start</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">📚 Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../data/index.html">Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/sequence_and_dataset.html">Sequence and Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/open_source_dataset.html">Open Source Datasets</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tools/index.html">Tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/grid.html">Grid System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/tokenizer.html">Tokenizer</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../training/index.html">Training</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../training/collate_function.html">Collate Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/lightning_data_module.html">Lightning DataModule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/lightning_cli.html">LightningCLI</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced/index.html">Advanced</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/arrow.html">BaseArrowDataSet</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">📜 Algorithms</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../available_algorithms/index.html">Algorithms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../available_algorithms/tuler.html">TULER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../available_algorithms/t2vec.html">T2VEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../available_algorithms/gmvsae.html">GM-VSAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../available_algorithms/stlstm.html">HST-LSTM</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Hands-on Example</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">T2VEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmvsae_example.html">GMVSAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="stlstm_example.html">STLSTM</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">📔 Supplementary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../supplementary/benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supplementary/references.html">Scientific Articles</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">📏 API Docs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/trajdl/trajdl.html">TrajDL</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.html">trajdl.algorithms package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.embeddings.html">trajdl.algorithms.embeddings package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.embeddings.base.html">trajdl.algorithms.embeddings.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.embeddings.ctle.html">trajdl.algorithms.embeddings.ctle module</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.framework.html">trajdl.algorithms.framework package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.loc_pred.html">trajdl.algorithms.loc_pred package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.loc_pred.rnn.html">trajdl.algorithms.loc_pred.rnn module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.loc_pred.stlstm.html">trajdl.algorithms.loc_pred.stlstm module</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.abstract.html">trajdl.algorithms.abstract module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.ctle.html">trajdl.algorithms.ctle module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.gmvsae.html">trajdl.algorithms.gmvsae module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.hier.html">trajdl.algorithms.hier module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.t2vec.html">trajdl.algorithms.t2vec module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.algorithms.tuler.html">trajdl.algorithms.tuler module</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.common.html">trajdl.common package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.common.enum.html">trajdl.common.enum module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.common.samples.html">trajdl.common.samples module</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.datasets.html">trajdl.datasets package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/trajdl/trajdl.datasets.arrow.html">trajdl.datasets.arrow package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.arrow.ext.html">trajdl.datasets.arrow.ext package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.arrow.abstract.html">trajdl.datasets.arrow.abstract module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.arrow.locseq.html">trajdl.datasets.arrow.locseq module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.arrow.schema.html">trajdl.datasets.arrow.schema module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.arrow.traj.html">trajdl.datasets.arrow.traj module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/trajdl/trajdl.datasets.base.html">trajdl.datasets.base package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.base.abstract.html">trajdl.datasets.base.abstract module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.base.locseq.html">trajdl.datasets.base.locseq module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.base.traj.html">trajdl.datasets.base.traj module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.html">trajdl.datasets.modules package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.abstract.html">trajdl.datasets.modules.abstract module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.ctle.html">trajdl.datasets.modules.ctle module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.gmvsae.html">trajdl.datasets.modules.gmvsae module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.hier.html">trajdl.datasets.modules.hier module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.stlstm.html">trajdl.datasets.modules.stlstm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.t2vec.html">trajdl.datasets.modules.t2vec module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.modules.tuler.html">trajdl.datasets.modules.tuler module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/trajdl/trajdl.datasets.open_source.html">trajdl.datasets.open_source package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.open_source.conf.html">trajdl.datasets.open_source.conf module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.open_source.hasher.html">trajdl.datasets.open_source.hasher module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.open_source.utils.html">trajdl.datasets.open_source.utils module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/trajdl/trajdl.datasets.sampler.html">trajdl.datasets.sampler package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.sampler.bucket.html">trajdl.datasets.sampler.bucket module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.sampler.session.html">trajdl.datasets.sampler.session module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/trajdl/trajdl.datasets.sampler.t2vec.html">trajdl.datasets.sampler.t2vec module</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.grid.html">trajdl.grid package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.grid.base.html">trajdl.grid.base module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.grid.hierarchy.html">trajdl.grid.hierarchy module</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.loss.html">trajdl.loss package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.loss.sampled_softmax.html">trajdl.loss.sampled_softmax module</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.metrics.html">trajdl.metrics package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.metrics.acc.html">trajdl.metrics.acc module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.metrics.tul.html">trajdl.metrics.tul module</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.tokenizers.html">trajdl.tokenizers package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.tokenizers.slot.html">trajdl.tokenizers.slot package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.tokenizers.abstract.html">trajdl.tokenizers.abstract module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.tokenizers.locseq.html">trajdl.tokenizers.locseq module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.tokenizers.simple.html">trajdl.tokenizers.simple module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.tokenizers.t2vec.html">trajdl.tokenizers.t2vec module</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trajdl/trajdl.utils.html">trajdl.utils package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trajdl/trajdl.utils.traj.html">trajdl.utils.traj module</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../api/trajdl/trajdl.config.html">trajdl.config module</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Spatial-Temporal-Data-Mining/TrajDL" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Spatial-Temporal-Data-Mining/TrajDL/edit/main/docs/examples/t2vec_example.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/t2vec_example.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>T2VEC</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#porto">Porto轨迹数据加载和预处理</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectorydataset">TrajectoryDataset的构建</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">网格系统</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tokenizer">Tokenizer的构建</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k">K近邻网格</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">训练和推理</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="t2vec">
<h1>T2VEC<a class="headerlink" href="#t2vec" title="Link to this heading">#</a></h1>
<p>在本篇文档中，我们将会使用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>来实现T2VEC算法。我们会以代码的形式介绍如下内容：</p>
<ul class="simple">
<li><p>Porto轨迹数据集的加载和预处理</p></li>
<li><p>原始数据集转化为TrajDL标准数据集</p></li>
<li><p>Tokenizer构建</p></li>
<li><p>T2VEC模型训练和推理</p></li>
</ul>
<section id="porto">
<h2>1.&nbsp;&nbsp;Porto轨迹数据加载和预处理<a class="headerlink" href="#porto" title="Link to this heading">#</a></h2>
<p>[Porto数据集]是波尔多市出租车轨迹数据，详细介绍见<a class="reference internal" href="../data/open_source_dataset.html"><span class="std std-doc">Open Source Datasets</span></a>。在这里我们将使用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>的<code class="docutils literal notranslate"><span class="pre">PortoDataset</span></code>接口来加载。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">trajdl.datasets.open_source</span> <span class="kn">import</span> <span class="n">PortoDataset</span>

<span class="c1"># 以polar.DataFrame的数据类型返回，为了便于展示，限制10000条数据</span>
<span class="n">porto</span> <span class="o">=</span> <span class="n">PortoDataset</span><span class="p">()</span>

<span class="n">original_trajs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">porto</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">return_as</span><span class="o">=</span><span class="s2">&quot;pl&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;MISSING_DATA&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;TIMESTAMP&quot;</span><span class="p">)[</span><span class="s2">&quot;POLYLINE&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">original_trajs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>load dataset: porto
</pre></div>
</div>
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1,)</small><table border="1" class="dataframe"><thead><tr><th>POLYLINE</th></tr><tr><td>list[array[f64, 2]]</td></tr></thead><tbody><tr><td>[[-8.610291, 41.140746], [-8.6103, 41.140755], … [-8.60589, 41.145345]]</td></tr></tbody></table></div></div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>还提供可扩展的<code class="docutils literal notranslate"><span class="pre">OpenSourceDataset</span></code>的接口来支持用户自行配置和加载开源数据集。</p>
</div>
</section>
<section id="trajectorydataset">
<h2>2.&nbsp;&nbsp;TrajectoryDataset的构建<a class="headerlink" href="#trajectorydataset" title="Link to this heading">#</a></h2>
<p>加载好Porto数据集之后，还无法直接用于模型的输入，需要将其转化为<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中的标准轨迹点序列数据<code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>，下面将介绍如何使用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中的API进行转换。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.contrib</span> <span class="kn">import</span> <span class="n">tenumerate</span>
<span class="kn">from</span> <span class="nn">trajdl.datasets</span> <span class="kn">import</span> <span class="n">Trajectory</span>

<span class="n">all_trajs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Trajectory</span><span class="p">(</span><span class="n">traj_pl</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">entity_id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">traj_pl</span> <span class="ow">in</span> <span class="n">tenumerate</span><span class="p">(</span><span class="n">original_trajs</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;transform trajectorys&quot;</span><span class="p">)</span>
<span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_trajs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">all_trajs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">seq</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "43275d8b7ed64bfc8335933ce8152cce"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trajectory(entity_id=0, length=25) [[-8.610291 41.140746]
 [-8.6103   41.140755]
 [-8.610309 41.14089 ]
 [-8.613657 41.141358]
 [-8.614602 41.141484]
 [-8.614242 41.142618]
 [-8.61363  41.143239]
 [-8.612883 41.143761]
 [-8.612208 41.144238]
 [-8.611542 41.144724]]
</pre></div>
</div>
</div>
</div>
<p>接下来，我们将<code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>切分为训练集、验证集和测试集部分。我们设定训练集800条轨迹，验证集和测试集分别是100条轨迹，序列最短长度是20，最大长度是100。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">trange</span>

<span class="c1"># 定义超参数</span>
<span class="n">NUM_TRAIN</span><span class="p">,</span> <span class="n">NUM_VAL</span><span class="p">,</span> <span class="n">TEST_START_IDX</span><span class="p">,</span> <span class="n">NUM_TEST</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">MIN_LENGTH</span><span class="p">,</span> <span class="n">MAX_LENGTH</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">MIN_LENGTH_TEST</span><span class="p">,</span> <span class="n">MAX_LENGTH_TEST</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">200</span>

<span class="n">all_trajs</span> <span class="o">=</span> <span class="n">all_trajs</span><span class="p">[:</span><span class="mi">1000</span><span class="p">]</span>

<span class="n">train_traj</span><span class="p">,</span> <span class="n">val_traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">NUM_TRAIN</span> <span class="o">+</span> <span class="n">NUM_VAL</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;construct train and val set&quot;</span><span class="p">):</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="n">all_trajs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">MIN_LENGTH</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MAX_LENGTH</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;=</span> <span class="n">NUM_TRAIN</span><span class="p">:</span>
            <span class="n">train_traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val_traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

<span class="n">test_traj</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">TEST_START_IDX</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_trajs</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;construct test set&quot;</span><span class="p">):</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="n">all_trajs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_traj</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">NUM_TEST</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="n">MIN_LENGTH_TEST</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MAX_LENGTH_TEST</span><span class="p">:</span>
        <span class="n">test_traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_traj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_traj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_traj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "53107221c65845d4a4efb0b75e9642ef"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "1112e73dea2a46c498c00c156e2b7503"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>661 83 29
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>如果数据集过于庞大，亦可以将其转换为<code class="docutils literal notranslate"><span class="pre">TrajectoryDatset</span></code>并使用<code class="docutils literal notranslate"><span class="pre">save</span></code>函数来将数据集保存在磁盘中。</p>
</div>
<section id="id1">
<h3>2.1.&nbsp;&nbsp;网格系统<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>对于上文得到的<code class="docutils literal notranslate"><span class="pre">TrajectoryDataset</span></code>，其中数据的基本形式是轨迹的经纬度点序列，我们需要将其离散化转换为类似于自然语言处理领域的<code class="docutils literal notranslate"><span class="pre">token</span></code>，后续作为<code class="docutils literal notranslate"><span class="pre">Embedding</span> <span class="pre">Layer</span></code>的输入来获取词向量嵌入表征。</p>
<p>因此，在<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中我们提供了<code class="docutils literal notranslate"><span class="pre">GridSystem</span></code>网格系统的API，读者使用该API可直接建立一套用于经纬度点转网格的系统，将连续的经纬度点离散化为网格（网格即为<code class="docutils literal notranslate"><span class="pre">token</span></code>）。另外，<code class="docutils literal notranslate"><span class="pre">GridSystem</span></code>底层封装了<code class="docutils literal notranslate"><span class="pre">C++</span></code>编写的<code class="docutils literal notranslate"><span class="pre">trajdl_cpp</span></code>工具来优化计算，详细的介绍参见<a class="reference internal" href="../tools/grid.html"><span class="std std-doc">网格系统</span></a>。</p>
<p>波尔多市的地图如<a class="reference internal" href="#porto-map">图1</a>所示，我们按照<span class="math notranslate nohighlight">\(100m \times 100m\)</span>为一个网格将地图进行切分，以此构建网格系统。</p>
<figure class="align-center" id="porto-map">
<a class="reference internal image-reference" href="../_images/porto_google_map.jpg"><img alt="Porto Map" src="../_images/porto_google_map.jpg" style="width: 500px;" />
</a>
<figcaption>
<p><span class="caption-text">图1. 波尔多市地图（图源：Google Map）</span><a class="headerlink" href="#porto-map" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>先创建网格系统在波尔多市的边界</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trajdl</span> <span class="kn">import</span> <span class="n">trajdl_cpp</span>

<span class="c1"># 基于经纬度系统的区域边界</span>
<span class="n">boundary_original</span> <span class="o">=</span> <span class="n">trajdl_cpp</span><span class="o">.</span><span class="n">RectangleBoundary</span><span class="p">(</span>
    <span class="n">min_x</span><span class="o">=-</span><span class="mf">8.690261</span><span class="p">,</span>
    <span class="n">min_y</span><span class="o">=</span><span class="mf">41.140092</span><span class="p">,</span>
    <span class="n">max_x</span><span class="o">=-</span><span class="mf">8.549155</span><span class="p">,</span>
    <span class="n">max_y</span><span class="o">=</span><span class="mf">41.185969</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># 转换为基于平面坐标系的区域边界</span>
<span class="n">boundary</span> <span class="o">=</span> <span class="n">boundary_original</span><span class="o">.</span><span class="n">to_web_mercator</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;boundary_original: </span><span class="si">{</span><span class="n">boundary_original</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;boundary: </span><span class="si">{</span><span class="n">boundary</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>boundary_original: RectangleBoundary(min_x=-8.690261, min_y=41.140092, max_x=-8.549155, max_y=41.185969)
boundary: RectangleBoundary(min_x=-967395.429381, min_y=5033027.213480, max_x=-951687.581313, max_y=5039810.867670)
</pre></div>
</div>
</div>
</div>
<p>通过打印的<code class="docutils literal notranslate"><span class="pre">boundary_original</span></code>和<code class="docutils literal notranslate"><span class="pre">boundary</span></code>两个变量可以看出这里存在两个坐标系统，一种是基于原始经纬度的坐标系统，另外一种是墨卡托投影系统，将原始的三维地球表面映射到二维平面系统。在T2VEC中使用的是墨卡托投影系统，该系统中数值的单位是”米“，在赤道处的比例是<span class="math notranslate nohighlight">\(1:1\)</span>（即墨卡托系统里赤道处的1米对应于1米的实际距离）。更为详细的介绍参见<a class="reference internal" href="../tools/grid.html"><span class="std std-doc">Grid</span></a>。</p>
<p>在<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中提供了将经纬度坐标转换为平面坐标的API：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">trajdl_cpp</span><span class="o">.</span><span class="n">convert_gps_to_webmercator</span><span class="p">(</span><span class="o">-</span><span class="mf">8.690261</span><span class="p">,</span> <span class="mf">41.140092</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trajdl_cpp</span><span class="o">.</span><span class="n">convert_gps_to_webmercator</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WebMercatorCoord(x=-967395.4293806, y=5033027.2134798)
WebMercatorCoord(x=0.0000000, y=-0.0000000)
</pre></div>
</div>
</div>
</div>
<p>可以看到经纬度坐标<span class="math notranslate nohighlight">\((0,0)\)</span>对应墨卡托投影系统中的坐标原点<span class="math notranslate nohighlight">\((0,0)\)</span>。下面我们在墨卡托系统中对波尔多市的地图进行网格系统的构建，一个网格单元的大小是<span class="math notranslate nohighlight">\(100m \times 100m\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trajdl.grid</span> <span class="kn">import</span> <span class="n">SimpleGridSystem</span>

<span class="c1"># 网格的划分距离为100m</span>
<span class="n">grid_width</span><span class="p">,</span> <span class="n">grid_height</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>

<span class="c1"># 创建网格系统</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">SimpleGridSystem</span><span class="p">(</span>
    <span class="c1"># 使用波尔多市的左下角点和右上角点来构建和切分网格系统</span>
    <span class="n">boundary</span><span class="p">,</span>
    <span class="n">step_x</span><span class="o">=</span><span class="n">grid_width</span><span class="p">,</span>
    <span class="n">step_y</span><span class="o">=</span><span class="n">grid_height</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="n">grid</span><span class="o">.</span><span class="n">num_x_grids</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">num_y_grids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10744 158 68
</pre></div>
</div>
</div>
</div>
<p>给定一个波尔多市的经纬度，即可映射到<code class="docutils literal notranslate"><span class="pre">SimpleGridSystem</span></code>中的一个网格<code class="docutils literal notranslate"><span class="pre">token</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 转墨卡托坐标系统</span>
<span class="n">web_mercator_location</span> <span class="o">=</span> <span class="n">trajdl_cpp</span><span class="o">.</span><span class="n">convert_gps_to_webmercator</span><span class="p">(</span><span class="o">-</span><span class="mf">8.610291</span><span class="p">,</span> <span class="mf">41.140746</span><span class="p">)</span>
<span class="c1"># 转网格id</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">web_mercator_location</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">web_mercator_location</span><span class="o">.</span><span class="n">y</span>
<span class="n">grid_id</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">locate_unsafe</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">web_mercator_location</span><span class="p">,</span> <span class="n">grid_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WebMercatorCoord(x=-958493.2097019, y=5033123.8845711) 89
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="tokenizer">
<h2>3.&nbsp;&nbsp;Tokenizer的构建<a class="headerlink" href="#tokenizer" title="Link to this heading">#</a></h2>
<p>在构建完<code class="docutils literal notranslate"><span class="pre">GridSystem</span></code>之后，我们要开始构建<code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>。在此处，<code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>的作用是给定一个输入的经纬度点（对应自然语言处理领域中一个<code class="docutils literal notranslate"><span class="pre">word</span></code>），使用<code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>将其转换为一个<code class="docutils literal notranslate"><span class="pre">token</span></code>，该<code class="docutils literal notranslate"><span class="pre">token</span></code>的表现形式是一个<code class="docutils literal notranslate"><span class="pre">int</span></code>类型的整数，作为<code class="docutils literal notranslate"><span class="pre">Embedding</span> <span class="pre">Layer</span></code>的输入来得到对应的<em>词嵌入表示</em>（word embedding）。</p>
<p>在<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中，我们提供了<code class="docutils literal notranslate"><span class="pre">T2VECTokenizer</span></code>的API来构建<code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">trajdl.tokenizers.t2vec</span> <span class="kn">import</span> <span class="n">T2VECTokenizer</span>

<span class="n">output_folder</span> <span class="o">=</span> <span class="s2">&quot;./output/t2vec&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">T2VECTokenizer</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="n">boundary_original</span><span class="p">,</span>
    <span class="n">trajectories</span><span class="o">=</span><span class="n">all_trajs</span><span class="p">,</span>
    <span class="n">max_vocab_size</span><span class="o">=</span><span class="mi">40000</span><span class="p">,</span>  <span class="c1"># 词表支持的词元上限，排序逻辑是词元在数据集中的频率</span>
    <span class="n">min_freq</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># 被命中至少min_freq次的网格称之为`hot cell`，tokenizer中仅保留`hot cell`</span>
    <span class="n">with_kd_tree</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tokenizer</span><span class="o">.</span><span class="n">save_pretrained</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;tokenizer.pkl&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;num vocab: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>num vocab:  23
</pre></div>
</div>
</div>
</div>
<p>在这里，解释一下<code class="docutils literal notranslate"><span class="pre">min_freq</span></code>和<code class="docutils literal notranslate"><span class="pre">with_kd_tree</span></code>这两个参数的意义：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>构建的词表越大，那么其后续的计算量越大复杂度越高，所以希望能够用最小的词表来表示整个数据集，所以在此处，就有<code class="docutils literal notranslate"><span class="pre">min_freq</span></code>这个参数来限制，当某个词元出现的频率小于<code class="docutils literal notranslate"><span class="pre">min_freq</span></code>的时候，<code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>会剔除掉该词元，以此方式来平衡词表的大小和词表的信息量。</p></li>
<li><p>基于上一点，如果轨迹序列的经纬度点命中了一些被剔除掉的网格<code class="docutils literal notranslate"><span class="pre">cell</span></code>，那么<code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>无法将该轨迹点转换为<code class="docutils literal notranslate"><span class="pre">token</span></code>。此时，我们提供了<code class="docutils literal notranslate"><span class="pre">KDTree</span></code>搜索的方法，将所有的<code class="docutils literal notranslate"><span class="pre">hot</span> <span class="pre">cell</span></code>构建<code class="docutils literal notranslate"><span class="pre">KDTree</span></code>，当轨迹点没有命中<code class="docutils literal notranslate"><span class="pre">hot</span> <span class="pre">cell</span></code>时，则会通过<code class="docutils literal notranslate"><span class="pre">KDTree</span></code>来搜索与该轨迹点最相近的<code class="docutils literal notranslate"><span class="pre">hot</span> <span class="pre">cell</span></code>作为其近似<code class="docutils literal notranslate"><span class="pre">token</span></code>。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>在<code class="docutils literal notranslate"><span class="pre">T2VECTokenizer</span></code>中传入的<code class="docutils literal notranslate"><span class="pre">boundary</span></code>变量是基于原始经纬度的<code class="docutils literal notranslate"><span class="pre">boundary_original</span></code>。</p>
</div>
</section>
<section id="k">
<h2>4.&nbsp;&nbsp;K近邻网格<a class="headerlink" href="#k" title="Link to this heading">#</a></h2>
<p>在<a class="reference internal" href="../available_algorithms/t2vec.html"><span class="std std-doc">T2VEC</span></a>中，作者为了计算基于位置距离加权的损失函数，还构建了两个矩阵，分别是当前网格的10个近邻网格索引的矩阵 <span class="math notranslate nohighlight">\(V\)</span> ( <span class="math notranslate nohighlight">\(N \times 10\)</span> )和当前网格的10个近邻网格距离的矩阵 <span class="math notranslate nohighlight">\(D\)</span> ( <span class="math notranslate nohighlight">\(N \times 10\)</span> )。在tokenizer中也集成了这两个矩阵的构建函数<code class="docutils literal notranslate"><span class="pre">k_nearest_hot_loc</span></code>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trajdl.common.enum</span> <span class="kn">import</span> <span class="n">TokenEnum</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># 10个最近的网格</span>
<span class="n">SPECIAL_TOKENS</span> <span class="o">=</span> <span class="n">TokenEnum</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="n">vocab_list</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>  <span class="c1"># 获取全部字典的Token</span>
<span class="n">loc_list</span><span class="p">,</span> <span class="n">idx_list</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="o">*</span><span class="p">((</span><span class="n">loc</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">loc2idx</span><span class="p">(</span><span class="n">loc</span><span class="p">))</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">vocab_list</span> <span class="k">if</span> <span class="n">loc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SPECIAL_TOKENS</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># 剔除special tokens字</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">dists</span><span class="p">,</span> <span class="n">locations</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">k_nearest_hot_loc</span><span class="p">(</span>
    <span class="n">loc_list</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span>
<span class="p">)</span>  <span class="c1"># 获取k个最近的网格以及对应的距离</span>

<span class="c1"># (num_locations, k)，索引矩阵</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vocab_list</span><span class="p">),</span> <span class="n">k</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="c1"># (num_locations, k)，距离矩阵</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">D</span><span class="p">[</span><span class="n">idx_list</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">dists</span>

<span class="c1"># 对于SPECIAL TOKENS，最近的token设定为自己</span>
<span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">SPECIAL_TOKENS</span><span class="p">:</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">loc2idx</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">V</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>

<span class="k">for</span> <span class="n">line_idx</span><span class="p">,</span> <span class="n">loc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx_list</span><span class="p">,</span> <span class="n">locations</span><span class="p">):</span>
    <span class="n">V</span><span class="p">[</span><span class="n">line_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">loc2idx</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">loc_list</span><span class="p">]</span>

<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;knn_indices.npy&quot;</span><span class="p">),</span> <span class="n">V</span><span class="p">)</span>  <span class="c1"># 保存k近邻网格的索引</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;knn_distances.npy&quot;</span><span class="p">),</span> <span class="n">D</span><span class="p">)</span>  <span class="c1"># 保留k近邻网格的距离</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>5.&nbsp;&nbsp;训练和推理<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中训练环节是基于<code class="docutils literal notranslate"><span class="pre">Lightning</span></code>框架编写的，典型的模块比如数据模块<code class="docutils literal notranslate"><span class="pre">T2VECDataModule</span></code>是继承自<code class="docutils literal notranslate"><span class="pre">LightningDataModule</span></code>、模型模块<code class="docutils literal notranslate"><span class="pre">T2VEC</span></code>是基于<code class="docutils literal notranslate"><span class="pre">LightningModule</span></code>模块编写的，用户可以通过简单几行代码，调用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中的<code class="docutils literal notranslate"><span class="pre">API</span></code>进行训练和推理。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>另外，<code class="docutils literal notranslate"><span class="pre">Lightning</span></code>框架还提供了命令行和配置文件的方式进行模型训练与验证。读者如果想对<code class="docutils literal notranslate"><span class="pre">Lightning</span></code>的命令行与配置文件有进一步的了解，可以阅读<a class="reference internal" href="../training/lightning_cli.html"><span class="std std-doc">LightningCLI</span></a>。</p>
</div>
<p>此处，我们仅展示使用<code class="docutils literal notranslate"><span class="pre">API</span></code>的方式来进行<code class="docutils literal notranslate"><span class="pre">T2VEC</span></code>模型的训练和推理。</p>
<p>首先，我们使用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>导入数据模块<code class="docutils literal notranslate"><span class="pre">T2VECDataModuleV2</span></code>，在该模块中的<code class="docutils literal notranslate"><span class="pre">collate_function</span></code>中实现了<code class="docutils literal notranslate"><span class="pre">downsampling</span></code>和<code class="docutils literal notranslate"><span class="pre">distortion</span></code>两种样本增强的方式。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trajdl.datasets</span> <span class="kn">import</span> <span class="n">TrajectoryDataset</span>
<span class="kn">from</span> <span class="nn">trajdl.datasets.modules.t2vec</span> <span class="kn">import</span> <span class="n">T2VECDataModuleV2</span>

<span class="c1"># 将Trajectory转换为TrajectoryDataset</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">TrajectoryDataset</span><span class="o">.</span><span class="n">init_from_trajectories</span><span class="p">(</span><span class="n">train_traj</span><span class="p">)</span>
<span class="n">val_dataset</span> <span class="o">=</span> <span class="n">TrajectoryDataset</span><span class="o">.</span><span class="n">init_from_trajectories</span><span class="p">(</span><span class="n">val_traj</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">TrajectoryDataset</span><span class="o">.</span><span class="n">init_from_trajectories</span><span class="p">(</span><span class="n">test_traj</span><span class="p">)</span>

<span class="n">data_module</span> <span class="o">=</span> <span class="n">T2VECDataModuleV2</span><span class="p">(</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
    <span class="n">train_table</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
    <span class="n">val_table</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
    <span class="n">test_table</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span>
    <span class="n">train_batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">val_batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">num_train_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_val_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_cpus</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>在上文中，我们使用了<a class="reference download internal" download="" href="../_downloads/9f141cfe551b1805157325775cf78d4d/t2vec.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">T2VECDataModuleV2</span></code></span></a>来构建数据模块，该模块在<a class="reference internal" href="../training/collate_function.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">collate_function</span></code></span></a>中实现了样本下采样和扭曲的变换方式，在训练迭代的过程中，会在线生成对比的样本。此外，在<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中还存在一种样本构建的方式，即离线样本构建，需要在训练之前将样本构建完毕存储到磁盘中，在训练时再从磁盘中加载样本到内存中，<a class="reference download internal" download="" href="../_downloads/9f141cfe551b1805157325775cf78d4d/t2vec.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">T2VECDataModule</span></code></span></a>中的初始化接受的<code class="docutils literal notranslate"><span class="pre">src_path</span></code>和<code class="docutils literal notranslate"><span class="pre">trg_path</span></code>即为离线构建的对比样本在磁盘中的路径。</p></li>
<li><p>此处为了演示<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中API的使用，采用了在线样本构建的<code class="docutils literal notranslate"><span class="pre">T2VECDataModuleV2</span></code>，但是在Benchmark中，为了复现论文实验效果，使用了离线样本构建的<code class="docutils literal notranslate"><span class="pre">T2VECDataModule</span></code>，具体参见T2VEC的Benchmark代码即可。</p></li>
</ol>
</div>
<p>执行如下代码可以得到训练数据集中第一个batch的数据</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_module</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="s2">&quot;fit&quot;</span><span class="p">)</span>
<span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">data_module</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">()</span>
<span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/multiprocessing/popen_fork.py:66: RuntimeWarning: Using fork() can cause Polars to deadlock in the child process.
In addition, using fork() with Python in general is a recipe for mysterious
deadlocks and crashes.

The most likely reason you are seeing this error is because you are using the
multiprocessing module on Linux, which uses fork() by default. This will be
fixed in Python 3.14. Until then, you want to use the &quot;spawn&quot; context instead.

See https://docs.pola.rs/user-guide/misc/multiprocessing/ for details.

If you really know what your doing, you can silence this warning with the warning module
or by setting POLARS_ALLOW_FORKING_THREAD=1.

  self.pid = os.fork()
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.12.8/x64/lib/python3.12/multiprocessing/popen_fork.py:66: RuntimeWarning: Using fork() can cause Polars to deadlock in the child process.
In addition, using fork() with Python in general is a recipe for mysterious
deadlocks and crashes.

The most likely reason you are seeing this error is because you are using the
multiprocessing module on Linux, which uses fork() by default. This will be
fixed in Python 3.14. Until then, you want to use the &quot;spawn&quot; context instead.

See https://docs.pola.rs/user-guide/misc/multiprocessing/ for details.

If you really know what your doing, you can silence this warning with the warning module
or by setting POLARS_ALLOW_FORKING_THREAD=1.

  self.pid = os.fork()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T2VECSample(src=tensor([[15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 12, 12, 12, 12, 12, 12, 12, 12,
         12, 12, 12, 12, 12, 12, 12, 12, 22, 22, 22, 22, 22],
        [15, 15, 15, 15, 15, 12, 12, 12, 12, 12, 12, 12, 12, 12,  9, 12, 12, 22,
         22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22],
        [14, 14, 14, 14, 14, 14, 14, 14, 14, 14,  2,  2,  4,  4,  4,  4,  4,  7,
         17, 17, 17, 17,  1,  1, 22, 22, 22, 22, 22, 22, 22],
        [14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,  2,  2,  2,  4,  4,  4,
          4,  7,  7, 17, 17, 17, 17, 17, 17, 17,  1,  1,  1]]), lengths=(26, 17, 24, 31), target=tensor([[18, 15, 15, 15, 15, 15, 15, 15, 15, 12, 12, 12, 12, 12, 12, 12, 12, 12,
         12, 12, 12, 12, 12, 12, 19, 22, 22, 22, 22, 22, 22],
        [18, 15, 15, 15, 15, 15, 15, 15, 15, 12, 12, 12, 12, 12, 12, 12, 12, 12,
         12, 12, 12, 12, 12, 12, 19, 22, 22, 22, 22, 22, 22],
        [18, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,  2,  2,  2,  4,  4,  4,
          4,  7,  7,  7, 17, 17, 17, 17, 17,  1,  1,  1, 19],
        [18, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,  2,  2,  2,  4,  4,  4,
          4,  7,  7,  7, 17, 17, 17, 17, 17,  1,  1,  1, 19]]))
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>此处的<code class="docutils literal notranslate"><span class="pre">T2VECDataModuleV2</span></code>继承自<code class="docutils literal notranslate"><span class="pre">BaseTrajectoryDataModule</span></code>，该模块可以直接接受<code class="docutils literal notranslate"><span class="pre">TrajectoryDataset</span></code>作为初始化数据集。</p>
</div>
<p>使用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中的API可以直接导入模型：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trajdl.algorithms.t2vec</span> <span class="kn">import</span> <span class="n">T2VEC</span>

<span class="c1"># 构建模型，我们使用默认参数，用户也可以根据文档修改模型的类型，比如使用GRU、LSTM等编码器</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">T2VEC</span><span class="p">(</span>
    <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">hidden_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
    <span class="n">knn_indices_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;knn_indices.npy&quot;</span><span class="p">),</span>
    <span class="n">knn_distances_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;knn_distances.npy&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T2VEC(
  (embedding): SimpleEmbedding(
    (embedding): Embedding(23, 256, padding_idx=22)
  )
  (encoder): T2VECEncoder(
    (emb): SimpleEmbedding(
      (embedding): Embedding(23, 256, padding_idx=22)
    )
    (encoder): GRU(256, 256, batch_first=True)
  )
  (decoder): DecoderWithAttention(
    (embedding_layer): SimpleEmbedding(
      (embedding): Embedding(23, 256, padding_idx=22)
    )
    (rnn): StackingGRU(
      (grus): ModuleList(
        (0): GRUCell(256, 256)
      )
      (dropout): Dropout(p=0.0, inplace=False)
    )
    (attention): GlobalAttention(
      (L1): Linear(in_features=256, out_features=256, bias=False)
      (L2): Linear(in_features=512, out_features=256, bias=False)
      (softmax): Softmax(dim=1)
      (tanh): Tanh()
    )
    (dropout): Dropout(p=0.0, inplace=False)
  )
  (projector): Sequential(
    (0): Linear(in_features=256, out_features=23, bias=True)
    (1): LogSoftmax(dim=1)
  )
  (loss_fn): KLDivLoss()
)
</pre></div>
</div>
</div>
</div>
<p>使用<code class="docutils literal notranslate"><span class="pre">PytorchLightning</span></code>中的<code class="docutils literal notranslate"><span class="pre">Trainer</span></code>，两行代码即可开始模型的训练，训练的结果在文件夹<code class="docutils literal notranslate"><span class="pre">lightning_logs</span></code>中。为了展示训练的流程，在此处的代码中仅训练一轮，在一轮训练结束执行，会在验证数据集<code class="docutils literal notranslate"><span class="pre">val_dataset</span></code>上进行验证。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lightning</span> <span class="k">as</span> <span class="nn">L</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">Trainer</span><span class="p">(</span><span class="n">max_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enable_checkpointing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data_module</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: False, used: False
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name      | Type                 | Params | Mode 
-----------------------------------------------------------
0 | embedding | SimpleEmbedding      | 5.9 K  | train
1 | encoder   | T2VECEncoder         | 400 K  | train
2 | decoder   | DecoderWithAttention | 597 K  | train
3 | projector | Sequential           | 5.9 K  | train
4 | loss_fn   | KLDivLoss            | 0      | train
-----------------------------------------------------------
997 K     Trainable params
460       Non-trainable params
998 K     Total params
3.993     Total estimated model params size (MB)
19        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "f6c9b6040ed248c29baf62090afd3b37"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "21331174405a4e0c9c2f7a234b8ab6c5"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "6707ca8e6537420db2f0eed2c9d3688f"}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_epochs=1` reached.
</pre></div>
</div>
</div>
</div>
<p>模型训练完成之后，即可开始在<code class="docutils literal notranslate"><span class="pre">test_dataset</span></code>上的推理，推理的代码如下：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># 先获取test_dataloader</span>
<span class="n">data_module</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">data_module</span><span class="o">.</span><span class="n">test_dataloader</span><span class="p">()</span>
<span class="n">test_sample_1</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">test_dataloader</span><span class="p">))</span>
<span class="n">test_sample_2</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">test_dataloader</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">inference_mode</span><span class="p">():</span>
    <span class="n">vec_1</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_sample_1</span><span class="p">)</span>
    <span class="n">vec_2</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_sample_2</span><span class="p">)</span>

<span class="n">batch_vec_1</span><span class="p">,</span> <span class="n">batch_vec_2</span> <span class="o">=</span> <span class="n">vec_1</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">vec_2</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">batch_vec_1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">batch_vec_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 256) (4, 256)
</pre></div>
</div>
</div>
</div>
<p>计算两个batch中样本两两之间的轨迹相似度：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">euclidean_distances</span>

<span class="nb">print</span><span class="p">(</span><span class="n">euclidean_distances</span><span class="p">(</span><span class="n">batch_vec_1</span><span class="p">,</span> <span class="n">batch_vec_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2.5102997  5.316877   8.71378    8.859084  ]
 [2.1860714  0.96959525 7.5382447  7.7232404 ]
 [8.079143   7.7566347  1.0531051  0.22841543]
 [8.108302   7.7894497  1.1811551  0.23038872]]
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>此处的API调用仅展示如何使用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>来快速开展<code class="docutils literal notranslate"><span class="pre">T2VEC</span></code>模型的训练和推理，论文中的消融实验的设计并非这样直接对测试数据进行推理后计算Embedding的相似度。</p></li>
<li><p>关于完整的实验，以及使用命令行和<code class="docutils literal notranslate"><span class="pre">YAML</span></code>配置文件的方式开展模型的训练和部署，可以参见 Benchmark中的内容，其中已经给出用于T2VEC复现的完整的配置文件和执行脚本，包括数据预处理、词嵌入模型预训练、模型的训练&amp;部署、论文实验的复现（在代码中也给出了诸多灵活使用<code class="docutils literal notranslate"><span class="pre">PytorchLighting</span></code>的示例代码供以学习参考）。</p></li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ol class="arabic simple">
<li><p>介绍了如果使用<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>中的<code class="docutils literal notranslate"><span class="pre">API</span></code>来进行T2VEC中数据集、tokenizer和增强样本的构建。</p></li>
<li><p>基于<code class="docutils literal notranslate"><span class="pre">TrajDL</span></code>快速开展T2VEC的训练和推理。</p></li>
</ol>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Hands-on Example</p>
      </div>
    </a>
    <a class="right-next"
       href="gmvsae_example.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">GMVSAE</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#porto">Porto轨迹数据加载和预处理</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectorydataset">TrajectoryDataset的构建</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">网格系统</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tokenizer">Tokenizer的构建</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k">K近邻网格</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">训练和推理</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Chao Song, Chaoqun Feng
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, All authors of TrajDL.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>